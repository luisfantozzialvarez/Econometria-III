% !TeX document-id = {0be8c18c-9430-4e9a-bdd9-12beadebfebc}
% !TeX TXS-program:bibliography = txs:///biber
\documentclass[11pt]{beamer}

\usepackage[brazilian]{babel}

\uselanguage{portuguese}
\languagepath{portuguese}
\deftranslation[to=portuguese]{Theorem}{Teorema}
\deftranslation[to=portuguese]{theorem}{teorema}
\deftranslation[to=portuguese]{Example}{Exemplo}
\deftranslation[to=portuguese]{example}{exemplo}
\deftranslation[to=portuguese]{Lemma}{Lema}
\deftranslation[to=portuguese]{lemma}{Lema}
\deftranslation[to=portuguese]{Corollary}{Corolário}
\deftranslation[to=portuguese]{corollary}{corolário}
%\deftranslation[to=portuguese]{and}{e}


\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{color}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{subcaption}
%\usepackage{appendixnumberbeamer}

\newenvironment{transitionframe}{
	\setbeamercolor{background canvas}{bg=yellow}
	\begin{frame}}{
	\end{frame}
}
\usetheme{default}
\usefonttheme{structuresmallcapsserif}

%% I use a beige off white for my background
\definecolor{MyBackground}{RGB}{255,253,218}
\useinnertheme[shadow]{rounded}
\setbeamercolor{block title}{bg=MyBackground}
\setbeamercolor{block body}{bg=MyBackground}
\setbeamercolor{example title}{bg=MyBackground}
\setbeamercolor{example body}{bg=MyBackground}


\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\purple}[1]{\textcolor{purple}{#1}}
\newcommand{\gray}[1]{\textcolor{gray}{#1}}
\setbeamertemplate{navigation symbols}{}
%\setbeamertemplate{page number in head/foot}[appendixframenumber]

%\usepackage{graphics}
\usepackage{graphicx}

\definecolor{blue_emph}{RGB}{0,114,178}
\definecolor{red}{RGB}{213,94,0}
\definecolor{yellow}{RGB}{240,228,66}
\definecolor{green}{RGB}{0,158,115}
\definecolor{purple}{RGB}{204,121,167}
\definecolor{orange}{RGB}{230,159,0}
\definecolor{lightblue}{RGB}{86,180,233}

%\setbeamercolor{frametitle}{fg=blue}
%\setbeamercolor{title}{fg=blue}
\setbeamertemplate{footline}[frame number]
\setbeamertemplate{navigation symbols}{} 
\setbeamertemplate{itemize items}{-}
%\setbeamercolor{itemize item}{fg=blue}
%\setbeamercolor{itemize subitem}{fg=blue}
\setbeamertemplate{enumerate items}[default]
%\setbeamercolor{enumerate subitem}{fg=blue}
\setbeamercolor{button}{bg=MyBackground,fg=blue}
\usefonttheme{structuresmallcapsserif}

%\setbeamercolor{section in toc}{fg=blue}
%\setbeamercolor{subsection in toc}{fg=red}
\setbeamersize{text margin left=1em,text margin right=1em} 


\usepackage{appendixnumberbeamer}

\usepackage[
backend=biber,
uniquename=false,
uniquelist=false,
style=authoryear,
natbib=true
]{biblatex}
\addbibresource{../bibliography.bib}

\newenvironment{wideitemize}{\itemize\addtolength{\itemsep}{10pt}}{\enditemize}
\newenvironment{wideenumerate}{\enumerate\addtolength{\itemsep}{10pt}}{\endenumerate}
\newenvironment{halfwideitemize}{\itemize\addtolength{\itemsep}{0.5em}}{\enditemize}
\newenvironment{halfwideenumerate}{\enumerate\addtolength{\itemsep}{0.5em}}{\endenumerate}


\author{Luis A. F. Alvarez}
\title{EAE1223: Econometria III}
\subtitle{Aula 8 - Modelos vetoriais autorregressivos estruturais}
%\logo{}
%\institute{}
\date{\today}
%\subject{}
%\setbeamercovered{transparent}

\begin{document}

\begin{frame}[plain]
	\maketitle
\end{frame}

\begin{frame}{Um modelo para a descrição de uma economia}
	\begin{itemize}
		\item 	Seja $\{ \boldsymbol{Y}_t\}_{t\in \mathbb{Z}}$ um processo vetorial de interesse, onde $\boldsymbol{Y}_t$ consiste de $d$ variáveis econômicas, sobre as quais a teoria econômica têm algo a nos dizer sobre o comportamento conjunto.
		\item Um {\color{blue}modelo estrutural (causal) linear} para estas variáveis consiste em um sistema de $d$ equações da forma:
		\begin{equation} \label{eq_struct}
			\boldsymbol{A}_0 \boldsymbol{Y}_t = \boldsymbol{a} + \sum_{j=1}^p\boldsymbol{A}_j \boldsymbol{Y}_{t-j} + \boldsymbol{\epsilon}_t\, ,
		\end{equation}
		onde $\boldsymbol{A}_0$ é uma matriz $d \times d$ que explicita as relações contemporâneas (causais) entre as variáveis, e $\boldsymbol{\epsilon}_t$ é um ruído branco {\color{blue}contemporaneamente não correlacionado}, isto é $$ \mathbb{V}[\boldsymbol{\epsilon}_t] = \begin{bmatrix}
			\sigma_{1}^2 & 0 & \ldots & 0 \\
			0 & \sigma^2_2 & \ldots & 0 \\
			\vdots & \ldots & \ddots & \vdots \\
			0 & 0 & \ldots & \sigma^2_d
		\end{bmatrix}= \Omega_\epsilon $$
		\end{itemize}


\end{frame}

\begin{frame}{Choques econômicos fundamentais }
	\begin{itemize}
		\item A hipótese de que os erros de cada uma das equações são contemporaneamente não correlacionados supõe que o modelo que descreve a economia esteja {\color{blue}bem especificado}, de modo que o choque da $j$-ésima equação reflete a incerteza econômica fundamental associada a $Y_{jt}$.
		\begin{itemize}
			\item $\epsilon_{jt}$ reflete choques (surpresas ou inovações, não antecipadas com base no passado) nos determinantes essenciais de $Y_{jt}$, e não nos determinantes indiretos (via outras variáveis do sistema) de $Y_{jt}$. 
	
		\end{itemize}
				\item Esse tipo de hipótese é presumida em uma das perguntas clássicas da macroeconomia: quanto da flutuação econômica pode ser atribuída à política monetária vs fatores reais?
				\begin{itemize}
					\item Pergunta presume que existem inovações fundamentais, contemporaneamente ortogonais (não correlacionadas), em fatores monetários e reais, que permitem pensar nesta decomposição, visto que ela não faz sentido se os fatores fundamentais não fossem fundamentais (i.e. correlacionados).
					\item Veremos como nossa metodologia permite fazer explicitamente esta decomposição.
				\end{itemize}
	
	\end{itemize}
\end{frame}

\begin{frame}{Exemplo}
	\begin{itemize}
			\item Considere o comportamento conjunto de inflação ($\pi_t$), desemprego ($u_t$), expectativas de inflação ($\pi^e_t$) e taxa de juros nominal ($i_t$):
	\end{itemize}
			\begin{align}
		\pi_t = \sum_{j={\color{blue}1}}^p \theta_j \pi_{t-j} + \sum_{j={\color{red}0}}^p \beta_j (u_{t-j}-\bar{u}_{\text{neutro}}) + \sum_{j={\color{red}0}}^p \gamma_j \pi_{t-j}^e + \epsilon_{\pi,t} \tag{CP} \\
		u_t - \bar{u} = \sum_{j={\color{blue}1}}^p \omega_j (u_{t-j}-\bar{u}) + \sum_{j={\color{red}0}}^p \alpha_j (i_{t-j} - \pi^e_{t-j})  + \epsilon_{u,t} \tag{IS} \\  i_t = \bar{i} + \sum_{j={\color{blue}1}}^p \psi_j i_{t-j} + \sum_{j={\color{red}0}}^p \kappa_j (\pi_{t-j}-\pi_{\text{M}}) + \sum_{j={\color{red}0}}^p \phi_j (\pi_{t-j}^e-\pi_{\text{M}}) + \epsilon_{i,t}\tag{RM}\\
		\pi^e_t = \mu \pi_{M} +  \sum_{j={\color{blue}1}}^p \iota_j \pi^e_{t-j} + \theta_3 \sum_{j={\color{red}0}}^p (\nu_{1j} \pi_{t-j} + \nu_{2j} u_{t-j} + \nu_{3j} i_{t-j}) + \epsilon_{e,t} \tag{FE}
	\end{align}
	onde $\epsilon_{\pi,t}$ são choques de oferta (CP), $\epsilon_{u,t}$ choques de demanda (IS), $\epsilon_{i,t}$ são surpresas de política monetária (RM), e $\epsilon_{e,t}$ são ruídos na formação de expectativas.

\end{frame}

\begin{frame}{Representação autorregressiva do modelo linear estrutural}
	\begin{itemize}
		\item Se o sistema \eqref{eq_struct} oferece uma descrição {\color{blue}completa} da evolução de $\boldsymbol{Y}_t$, então, para uma dada trajetória pretérita $\{\boldsymbol{Y}_s: s \leq t-1\}$, e valores dos choques fundamentais $\boldsymbol{\epsilon}_t$, existe um único valor de $\boldsymbol{Y}_t$  que satisfaz \eqref{eq_struct}.
		\item Nesse caso, a matriz $\boldsymbol{A}_0$ admite inversa $\boldsymbol{B}= \boldsymbol{A}_0^{-1}$, e o sistema admite {\color{blue}representação autorregressiva}:
		
		\begin{equation}
			\label{eq_arriv}
			\boldsymbol{Y}_t = \underbrace{\boldsymbol{c}}_{= \boldsymbol{B}\boldsymbol{a}} + \sum_{j=1}^p \underbrace{\boldsymbol{C}_j}_{=\boldsymbol{B} \boldsymbol{A}_j} \boldsymbol{Y}_{t-j}  + \boldsymbol{B}\boldsymbol{\epsilon}_t\, .
		\end{equation}
		
		\item Modelo VAR em que o ruído branco $\boldsymbol{B}\boldsymbol{\epsilon}_t$ é uma combinação linear de choques fundamentais.
		\item Matriz $\boldsymbol{B}$ incorpora o efeito contemporâneo de inovações fundamentais sobre as variáveis em $\boldsymbol{Y}_t$. 
	\end{itemize}
\end{frame}

\begin{frame}{Modelo SVAR(p)}
\begin{itemize}
	\item 	Em diversas situações, não necessariamente queremos partir de \eqref{eq_struct} para chegar a \eqref{eq_arriv}
	\begin{itemize}
		\item Não necessariamente temos uma descrição completa da economia.
		\item De modo relacionado, a formulação \eqref{eq_arriv} pode ser compatível com mais de uma formulação estrutural linear completa.
	\end{itemize}
	\item Nesses casos, podemos definir diretamente {\color{blue}um modelo vetorial autorregressivo (semi)estrutural de ordem $p$}, SVAR(p), como o processo
	
		\begin{equation}
		\label{eq_svar}
		\boldsymbol{Y}_t = \boldsymbol{c}+ \sum_{j=1}^p \boldsymbol{C}_j \boldsymbol{Y}_{t-j} + \boldsymbol{B}\boldsymbol{\epsilon}_t\, ,
	\end{equation}
	onde $\boldsymbol{\epsilon}_t$ são inovações fundamentais, isto é ruídos brancos não contemporaneamente correlacionados, e $\boldsymbol{B}$ é a matriz que captura os efeitos contemporâneos das inovações fundamentais sobre $\boldsymbol{Y}_t$.
\end{itemize}
\end{frame}

\begin{frame}{Função de resposta ao impulso}
	\begin{itemize}
		\item Os efeitos causais dinâmicos, na modelagem SVAR, são capturados pelos efeitos de surpresas dos choques fundamentais sobre o comportamento do sistema.
		\begin{itemize}
			\item Note que, por construção, $\boldsymbol{\epsilon}_t$ captura fatores não antecipados com base no passado. 
			\item Como $\boldsymbol{\epsilon}_t$ é não contemporaneamente correlacionado, faz sentido pensar em surpresas em um de seus componentes, mantidos os outros constantes.
	\end{itemize}
	\item Formalmente, o efeito causal de uma surpresa de uma unidade na $j$-ésima variável do sistema em $t$, $\epsilon_{jt}$, sobre a $i$-ésima variável do sistema em $t+h$, $h\geq 0$, é dada pela {\color{blue}função de resposta ao impulso}
	$$F_{h}(i|j)  = \frac{\partial Y_{i,t+h}}{\partial \epsilon_{j,t}}$$
	\item  $F_{0}(i|j) = \boldsymbol{B}_{ij}$, $F_{1}(i|j) = \sum_{l=1}^d\boldsymbol{C}_{1, i,l} \boldsymbol{B}_{lj} = \sum_{l=1}^d\boldsymbol{C}_{1, i,l} F_{0}(l|j)$, $F_2(i|j) = \sum_{l=1}^d \boldsymbol{C}_{1, i,l} F_{1}(i|j) + \sum_{l=1}^d\boldsymbol{C}_{2, i,l} F_{0}(i|j)$, etc.
	\end{itemize}
\end{frame}

\begin{frame}{FRI normalizada, FRI acumulada}
\begin{itemize}
	\item Em diversos casos, é costumeiro normalizar a FRI pelo desvio padrão dos choques, isto é, reporta-se:
	$$F_h(i|j)/\sigma_{j,t}\,.$$
	
	\begin{itemize}
		\item 	Neste caso, os coeficientes são interpretáveis como o efeito causal de uma surpresa de um desvio padrão na $j$-ésima variável.
	\end{itemize}
	\item Também podemos reportar a FRI acumulada:
	
	$$\sum_{\tau=0}^h F_\tau(i|j)\, .$$
	
	\begin{itemize}
		\item Se a $i$-ésima variável está em primeiras diferenças, a FRI acumulada reporta o efeito da surpresa sobre o nível da série em $t+h$.
		\item Alternativamente, FRI acumulada pode ser interpretada como o efeito de uma sequência de surpresas (por construção, não antecipadas) de uma unidade em $j$ por $h$ períodos sobre o sistema.
		\begin{itemize}
			\item Note que, pela crítica de Lucas, sabemos que isto é \textbf{diferente} do efeito de um aumento permanente de uma unidade sobre a $j$-ésima variável do sistema.
		\end{itemize}
	\end{itemize}
	
\end{itemize}
\end{frame}


\begin{frame}{Decomposição da variância do erro de predição}
		\begin{itemize}
		\item Com base no SVAR(p), somos capazes, analogamente ao VAR(p), de calcular previsões para $T+h$, com dados até $T$, $\boldsymbol{Y}_{T+h|T}$:
		\begin{align*}
			\boldsymbol{Y}_{T+1|T} = \boldsymbol{c} + \sum_{j=0}^{p-1} \boldsymbol{C}_{j+1} \boldsymbol{Y}_{T-j} \\
				\boldsymbol{Y}_{T+2|T} = \boldsymbol{c} +  {\color{red}\boldsymbol{C}_{j}\boldsymbol{Y}_{T+1|T}} +  \sum_{j=0}^{p-2} \boldsymbol{C}_{j+2} \boldsymbol{Y}_{T-j}  \\
				vdots
		\end{align*}
	\end{itemize}
	\begin{itemize}
\item O erro de previsão no horizonte $h$ é dado por $\boldsymbol{Y}_{T+h} - \boldsymbol{Y}_{T+h|T}$.
\item Dada a natureza estrutural dos choques, é possível mostrar que somos capazes de decompor aditivamente a {\color{blue}variância do erro de previsão de cada variável} na contribuição de cada choque:

$$\mathbb{V}[\boldsymbol{Y}_{i,T+h} - \boldsymbol{Y}_{i, T+h|T}] = \sum_{j=1}^d \text{contribuição do choque j}$$
	\end{itemize}
\end{frame}

\begin{frame}{Decomposição da variância do erro de predição (cont.)}
	\begin{halfwideitemize}

		\item Decomposição da variância erro de predição nos permite dizer, para cada horizonte, quantos \% da incerteza futura depende de cada uma das inovações estruturais.
				\item Fácil de ver que a decomposição não depende de $t$, mas tão somente do horizonte e variável de interesse,
		\item Se tomamos $h \to \infty$, temos uma decomposição da variância de longo prazo (incondicional) do sistema.
		\begin{itemize}
			\item Por exemplo, podemos dizer quanto da variabilidade da atividade econômica se deve a choques monetários.
		\end{itemize}
	\end{halfwideitemize}
\end{frame}


\begin{frame}{SVAR(p) e VAR(p)}
\begin{itemize}
	\item Note que um SVAR(p) da forma \eqref{eq_svar} sempre define um VAR(p).
	\item De fato, se definimimos $\boldsymbol{u}_t = \boldsymbol{B}\boldsymbol{\epsilon}_t$,  podemos escrever:
	\begin{equation}
		\label{eq_rvar}
		\boldsymbol{Y}_t = \boldsymbol{c}+ \sum_{j=1}^p \boldsymbol{C}_j \boldsymbol{Y}_{t-j} + \boldsymbol{u}_t\, ,
	\end{equation}
	onde $\boldsymbol{u}_t$ é um {\color{blue}ruído branco contemporaneamente correlacionado}, cuja matriz de variância é dada por $\mathbb{V}[\boldsymbol{u}_t] = \boldsymbol{B}\mathbb{V}[\boldsymbol{\epsilon}_t] \boldsymbol{B}' =\Sigma$.
	\begin{itemize}
		\item VAR(p) em que ruído branco segue da combinação linear de choques estruturais.
		\item Essas combinações lineares produzem um ruído branco contemporaneamente correlacionado, na medida em que choques fundamentais afetam simultaneamente mais de uma variável do sistema.
	\end{itemize}
	\item A um VAR(p) derivado de um SVAR(p), daremos o nome de {\color{blue}modelo vetorial em forma reduzida}.
\end{itemize}
\end{frame}

\begin{frame}{O problema de identificação causal no SVAR(p)}
\begin{itemize}
	\item Recorde-se que, sob condições bastantes gerais, podemos estimar consistentemente os parâmetros de um VAR(p).
	\begin{itemize}
		\item Resultado vale para séries estacionárias, e mesmo para processos integrados (embora, nesse caso, a inferência com base em distribuições convencionais não seja válida).
	\end{itemize}
	\item Como os parâmetros do VAR(p) são consistentemente estimáveis, segue que, com $T$ grande, somos capazes de recuperar aproximadamente as {\color{blue}inovações reduzidas} $\{\boldsymbol{u}_t : 1 \leq t \leq T\}$. 
	\begin{itemize}
		\item Como essas inovações são recuperáveis com $T$ grande, também somos capazes de estimar consistentemente $\Sigma = \mathbb{V}[\boldsymbol{u}_t]$.
	\end{itemize}
	\item O {\color{blue}problema de identificação causal no SVAR(p)} consiste em prover condições a partir das quais sejamos capazes de {\color{blue}recuperar os choques estruturais $\boldsymbol{\epsilon}_t$ a partir da observação de $\boldsymbol{u}_t$}.
	\begin{itemize}
		\item Ideia é encontrar condições que nos permitam descorrelacionar os choques reduzidos em termos das inovações fundamentais.
	\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Identificação dos choques estruturais}
	\begin{itemize}
		\item Para descorrelacionar $\boldsymbol{u}_t$, precisamos recuperar a matriz $\boldsymbol{B}$.
		\item Em geral, as análises estruturais preferem ser agnósticas sobre os componentes autorregressivos do processo $\implies$ coeficientes $\boldsymbol{C}_j$ não nos trazem informação sobre $\boldsymbol{B}_j$.
		\begin{itemize}
			\item Componentes autorregressivos aparecem pois queremos ser relativamente agnósticos sobre a ``propagação'' de choques intertemporalmente (teoria dificilmente nos diz algo sobre isso), o que sugere não restringir sua relação com os $\boldsymbol{B}_j$.
		\end{itemize}
		\item Nesses casos, única informação para descorrelacionar choques deve vir da própria distribuição dos $\boldsymbol{u}_t$.
		\item Em particular, se queremos ser também agnósticos sobre a distribuição dos choques estruturais $\boldsymbol{\epsilon}_t$, é possível mostrar que a única fonte de informações sobre $\boldsymbol{B}$ vêm da equação:
		
		$$\mathbb{V}[\boldsymbol{u}_t] = \boldsymbol{B}\mathbb{V}[\boldsymbol{\epsilon}_t] \boldsymbol{B}'$$
		onde somos capazes de recuperar o lado esquerdo, com $T$ grande.
		\begin{itemize}
			\item Problema de identificação passa a ser separar, a partir da observação de $\mathbb{V}[\boldsymbol{u}_t]$, a variância dos choques estruturais $\mathbb{V}[\boldsymbol{\epsilon}_t]$ da matriz $\boldsymbol{B}$.
		\end{itemize}
	\end{itemize}
\end{frame}
\begin{frame}{Restrições faltantes}
	\begin{itemize}
		\item Precisamos recuperar os parâmetros das matrizes $\mathbb{V}[\boldsymbol{\epsilon}_t]$ ($d$ parâmetros) e $\boldsymbol{B}$ ($d^2$ parâmetros) de {\color{blue}forma única} a partir de $\mathbb{V}[\boldsymbol{u}_t]$.
		\item A observação (em amostras grandes) de $\mathbb{V}[\boldsymbol{u}_t]$ nos provê $d(d-1)/2 + d$ restrições.
		\begin{itemize}
			\item Diagonal principal e região abaixo dela.
		\end{itemize}
		\item Dessa forma, temos um sistema com $d(d-1)/2 + d$ equações e $d(d+1)$ incógnitas.
		\begin{itemize}
			\item Precisamos de restrições adicionais para recuperar esses parâmetros de forma única.
		\end{itemize}
		\item Uma normalização natural é supor que a diagonal principal de $\boldsymbol{B}$ é igual a $1$.
		\begin{itemize}
			\item {\color{blue}Escala dos choques estruturais corresponde às variáveis observadas}, de modo que choque de uma unidade em $\boldsymbol{\epsilon}_{j,t}$ corresponde a aumento não antecipado de uma unidade em $\boldsymbol{Y}_{j,t}$.
		\end{itemize}
		\item Nesse caso, temos um sistema com $d(d+1)/2$ equações e $d^2$ incógnitas.
		\begin{itemize}
			\item Precisamos de $d(d-1)/2$ restrições sobre os parâmetros estruturais para identificar o sistema. 
		\end{itemize}
		
	\end{itemize}
\end{frame}
%\appendix
%\begin{frame}[allowframebreaks]{Referências}
%	\printbibliography
%\end{frame}
\end{document}

